(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72426,e=>{"use strict";let{useGetAllCoursesQuery:s,useGetCourseByIdQuery:t,useGetCourseWorkoutsQuery:r,useResetCourseProgressMutation:i}=e.i(38114).apiSlice.injectEndpoints({endpoints:e=>({getAllCourses:e.query({query:()=>"/courses",providesTags:["Course"],keepUnusedDataFor:3600}),getCourseById:e.query({query:e=>`/courses/${e}`,providesTags:(e,s,t)=>[{type:"Course",id:t}],keepUnusedDataFor:1800}),getCourseWorkouts:e.query({query:e=>`/courses/${e}/workouts`,providesTags:["Workout"]}),resetCourseProgress:e.mutation({query:e=>({url:`/courses/${e}/reset`,method:"PATCH"}),invalidatesTags:["Progress","Course"]})})});e.s(["useGetAllCoursesQuery",0,s,"useGetCourseByIdQuery",0,t,"useGetCourseWorkoutsQuery",0,r,"useResetCourseProgressMutation",0,i])},87668,e=>{"use strict";let{useGetUserProgressQuery:s,useSaveWorkoutProgressMutation:t,useResetWorkoutProgressMutation:r}=e.i(38114).apiSlice.injectEndpoints({endpoints:e=>({getUserProgress:e.query({query:({courseId:e,workoutId:s})=>{let t=`/users/me/progress?courseId=${e}`;return s&&(t+=`&workoutId=${s}`),t},providesTags:["Progress"],keepUnusedDataFor:60}),saveWorkoutProgress:e.mutation({query:({courseId:e,workoutId:s,progressData:t})=>({url:`/courses/${e}/workouts/${s}`,method:"PATCH",body:{progressData:t}}),invalidatesTags:["Progress"]}),resetWorkoutProgress:e.mutation({query:({courseId:e,workoutId:s})=>({url:`/courses/${e}/workouts/${s}/reset`,method:"PATCH"}),invalidatesTags:["Progress"]})})});e.s(["useGetUserProgressQuery",0,s])},67585,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return i}});let r=e.r(32061);function i({reason:e,children:s}){if("undefined"==typeof window)throw Object.defineProperty(new r.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return s}},9885,(e,s,t)=>{"use strict";function r(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"encodeURIPath",{enumerable:!0,get:function(){return r}})},52157,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return d}});let r=e.r(43476),i=e.r(74080),l=e.r(63599),a=e.r(9885),o=e.r(43369);function d({moduleIds:e}){if("undefined"!=typeof window)return null;let s=l.workAsyncStorage.getStore();if(void 0===s)return null;let t=[];if(s.reactLoadableManifest&&e){let r=s.reactLoadableManifest;for(let s of e){if(!r[s])continue;let e=r[s].files;t.push(...e)}}if(0===t.length)return null;let d=(0,o.getDeploymentIdQueryOrEmptyString)();return(0,r.jsx)(r.Fragment,{children:t.map(e=>{let t=`${s.assetPrefix}/_next/${(0,a.encodeURIPath)(e)}${d}`;return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style",nonce:s.nonce},e):((0,i.preload)(t,{as:"script",fetchPriority:"low",nonce:s.nonce}),null)})})}},69093,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let r=e.r(43476),i=e.r(71645),l=e.r(67585),a=e.r(52157);function o(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},u=function(e){let s={...d,...e},t=(0,i.lazy)(()=>s.loader().then(o)),u=s.loading;function n(e){let o=u?(0,r.jsx)(u,{isLoading:!0,pastDelay:!0,error:null}):null,d=!s.ssr||!!s.loading,n=d?i.Suspense:i.Fragment,c=s.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(a.PreloadChunks,{moduleIds:s.modules}):null,(0,r.jsx)(t,{...e})]}):(0,r.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(t,{...e})});return(0,r.jsx)(n,{...d?{fallback:o}:{},children:c})}return n.displayName="LoadableComponent",n}},70703,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let r=e.r(55682)._(e.r(69093));function i(e,s){let t={};"function"==typeof e&&(t.loader=e);let i={...t,...s};return(0,r.default)({...i,modules:i.loadableGenerated?.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),s.exports=t.default)},83995,e=>{e.v({exercises__box:"page-module__ivsW8a__exercises__box",exercises__but:"page-module__ivsW8a__exercises__but",exercises__link:"page-module__ivsW8a__exercises__link",exercises__min:"page-module__ivsW8a__exercises__min",exercises__scrollbar:"page-module__ivsW8a__exercises__scrollbar",exercises__sidebar:"page-module__ivsW8a__exercises__sidebar",exercises__text:"page-module__ivsW8a__exercises__text",exercises__title:"page-module__ivsW8a__exercises__title",progressBar:"page-module__ivsW8a__progressBar",selectedCount:"page-module__ivsW8a__selectedCount",video:"page-module__ivsW8a__video",video__exercises:"page-module__ivsW8a__video__exercises",video__player:"page-module__ivsW8a__video__player",video__title:"page-module__ivsW8a__video__title"})},23720,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(83995),i=e.i(22016),l=e.i(70703),a=e.i(18566),o=e.i(90704),d=e.i(72426),u=e.i(87668);let{useGetWorkoutByIdQuery:n}=e.i(38114).apiSlice.injectEndpoints({endpoints:e=>({getWorkoutById:e.query({query:e=>`/workouts/${e}`,providesTags:(e,s,t)=>[{type:"Workout",id:t}],keepUnusedDataFor:600})})}),c=(0,l.default)(()=>e.A(40968),{loadableGenerated:{modules:[77526]},loading:()=>(0,s.jsx)("div",{className:r.default.videoLoading,children:"Загрузка плеера..."}),ssr:!1}),_=(0,l.default)(()=>e.A(67898),{loadableGenerated:{modules:[63978]},loading:()=>(0,s.jsx)("div",{children:"Загрузка формы..."})}),f=(0,l.default)(()=>e.A(64008),{loadableGenerated:{modules:[6376]},loading:()=>(0,s.jsx)("div",{children:"Загрузка..."})});function p({params:e}){let[l,p]=(0,t.useState)([]),[x,m]=(0,t.useState)(null),[g,h]=(0,t.useState)({}),[v,y]=(0,t.useState)(!0),[j,b]=(0,t.useState)(null),[k,P]=(0,t.useState)(""),[C,N]=(0,t.useState)(!1),[S,w]=(0,t.useState)(!1),[W,I]=(0,t.useState)(""),[O,T]=(0,t.useState)([]);(0,a.useRouter)();let A=(0,a.useSearchParams)(),E=A?.get("courseId")||"",R=A?.get("workoutIds")||"",[U,q]=(0,t.useState)([]);(0,t.useEffect)(()=>{(async()=>{let{id:s}=await e;P(s),R&&q(decodeURIComponent(R).split(","))})()},[e,R]);let{data:$,isLoading:B}=n(k,{skip:!k}),{data:M,isLoading:D}=(0,d.useGetCourseByIdQuery)(E,{skip:!E}),{data:G}=(0,u.useGetUserProgressQuery)({courseId:E},{skip:!E||!(0,o.isAuthenticated)()}),{data:Q}=(0,d.useGetCourseWorkoutsQuery)(E,{skip:!E});(0,t.useEffect)(()=>{(async()=>{if(Q&&0!==U.length)try{let e=Q.filter(e=>U.includes(e._id));p(e)}catch(e){console.error("Ошибка фильтрации тренировок:",e)}})()},[Q,U]),(0,t.useEffect)(()=>{if(M&&m(M),G?.workoutsProgress){let e={};G.workoutsProgress.forEach(s=>{e[s.workoutId]=s}),h(e)}U.length>0&&Q?!M||D||B||y(!1):$&&M&&(p([$]),D||B||y(!1)),D||B||!E||!k||M||$||(b("Не удалось загрузить данные тренировки"),y(!1))},[$,M,G,Q,D,B,E,k,U]),(0,t.useEffect)(()=>{!k||E||v||(b('ID курса не указан. Пожалуйста, перейдите из раздела "Мои курсы"'),y(!1))},[k,E,v]);let F=(e,s)=>{let t=g[e],r=l.find(s=>s._id===e);if(!r||!r.exercises[s])return 0;let i=r.exercises[s],a=t?.progressData[s]||0,o=i.quantity;return 0===o?0:Math.min(Math.round(a/o*100),100)};return v?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:r.default.video,children:[(0,s.jsx)("h1",{className:r.default.video__title,children:"Загрузка тренировок..."}),(0,s.jsx)("div",{className:r.default.video__player,children:(0,s.jsx)(c,{})})]})}):j?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:r.default.video,children:[(0,s.jsx)("h1",{className:r.default.video__title,children:"Ошибка"}),(0,s.jsx)("p",{style:{textAlign:"center",color:"red",padding:"20px"},children:j}),(0,s.jsx)("div",{className:r.default.exercises__but,children:(0,s.jsx)(i.default,{href:"/",className:r.default.exercises__link,children:"Вернуться на главную"})})]})}):l.length&&x?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:r.default.title,children:(0,s.jsx)("h1",{className:r.default.video__title,children:x.nameRU})}),l.map((e,t)=>{var a;let d;return a=e._id,(d=l.find(e=>e._id===a))&&0!==d.exercises.length&&d.exercises.reduce((e,s,t)=>e+F(a,t),0)/d.exercises.length,(0,s.jsxs)("div",{className:r.default.video,children:[(0,s.jsx)(c,{videoUrl:e.video}),(0,s.jsxs)("div",{className:r.default.video__exercises,children:[(0,s.jsxs)("h4",{className:r.default.exercises__title,children:["Упражнения тренировки ",t+1]}),(0,s.jsx)("div",{className:r.default.exercises__box,children:e.exercises.map((t,i)=>{let l=F(e._id,i);return(0,s.jsxs)("div",{className:r.default.exercises__min,children:[(0,s.jsxs)("p",{className:r.default.exercises__text,children:[t.name," ",l,"%"]}),(0,s.jsx)("div",{className:r.default.progressControls,children:(0,s.jsx)("div",{className:r.default.exercises__sidebar,children:(0,s.jsx)("div",{className:r.default.progressBar,style:{width:`${l}%`}})})})]},t._id||i)})}),(0,s.jsx)("div",{className:r.default.exercises__but,onClick:()=>(e=>{I(e);let s=l.find(s=>s._id===e);if(s){let t=g[e];T(t?.progressData||Array(s.exercises.length).fill(0))}N(!0)})(e._id),style:{cursor:"pointer"},children:(0,o.isAuthenticated)()?(0,s.jsx)("div",{className:r.default.exercises__link,children:"Обновить свой прогресс"}):(0,s.jsx)(i.default,{href:"/page/SignIn",className:r.default.exercises__link,children:"Обновить свой прогресс"})})]})]},e._id)}),W&&(0,s.jsx)(_,{isOpen:C,onClose:()=>{N(!1),I("")},userEmail:"",loginName:"",courseId:E,workoutId:W,exercises:l.find(e=>e._id===W)?.exercises||[],currentProgress:O,onProgressSaved:e=>{h(s=>({...s,[W]:{workoutId:W,workoutCompleted:e.every(e=>e>0),progressData:e}})),w(!0)}}),(0,s.jsx)(f,{isOpen:S,onClose:()=>{w(!1)},userEmail:"",loginName:""})]}):(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:r.default.video,children:[(0,s.jsx)("h1",{className:r.default.video__title,children:"Тренировки не найдены"}),(0,s.jsx)("p",{style:{textAlign:"center",padding:"20px"},children:"Тренировки не существуют или были удалены"}),(0,s.jsx)("div",{className:r.default.exercises__but,children:(0,s.jsx)(i.default,{href:"/",className:r.default.exercises__link,children:"Вернуться на главную"})})]})})}e.s(["default",()=>p],23720)},40968,e=>{e.v(s=>Promise.all(["static/chunks/e12db8b070cd41c1.css","static/chunks/4c2c6cb354736282.js"].map(s=>e.l(s))).then(()=>s(77526)))},67898,e=>{e.v(s=>Promise.all(["static/chunks/d35d364e37ac2334.css","static/chunks/241e915cb4f8b365.js"].map(s=>e.l(s))).then(()=>s(63978)))},64008,e=>{e.v(s=>Promise.all(["static/chunks/97800e2f2ed179ac.css","static/chunks/8e2476ca1225beb8.js"].map(s=>e.l(s))).then(()=>s(6376)))}]);