(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72426,e=>{"use strict";let{useGetAllCoursesQuery:s,useGetCourseByIdQuery:r,useGetCourseWorkoutsQuery:o,useResetCourseProgressMutation:t}=e.i(38114).apiSlice.injectEndpoints({endpoints:e=>({getAllCourses:e.query({query:()=>"/courses",providesTags:["Course"],keepUnusedDataFor:3600}),getCourseById:e.query({query:e=>`/courses/${e}`,providesTags:(e,s,r)=>[{type:"Course",id:r}],keepUnusedDataFor:1800}),getCourseWorkouts:e.query({query:e=>`/courses/${e}/workouts`,providesTags:["Workout"]}),resetCourseProgress:e.mutation({query:e=>({url:`/courses/${e}/reset`,method:"PATCH"}),invalidatesTags:["Progress","Course"]})})});e.s(["useGetAllCoursesQuery",0,s,"useGetCourseByIdQuery",0,r,"useGetCourseWorkoutsQuery",0,o,"useResetCourseProgressMutation",0,t])},87668,e=>{"use strict";let{useGetUserProgressQuery:s,useSaveWorkoutProgressMutation:r,useResetWorkoutProgressMutation:o}=e.i(38114).apiSlice.injectEndpoints({endpoints:e=>({getUserProgress:e.query({query:({courseId:e,workoutId:s})=>{let r=`/users/me/progress?courseId=${e}`;return s&&(r+=`&workoutId=${s}`),r},providesTags:["Progress"],keepUnusedDataFor:60}),saveWorkoutProgress:e.mutation({query:({courseId:e,workoutId:s,progressData:r})=>({url:`/courses/${e}/workouts/${s}`,method:"PATCH",body:{progressData:r}}),invalidatesTags:["Progress"]}),resetWorkoutProgress:e.mutation({query:({courseId:e,workoutId:s})=>({url:`/courses/${e}/workouts/${s}/reset`,method:"PATCH"}),invalidatesTags:["Progress"]})})});e.s(["useGetUserProgressQuery",0,s])},80127,e=>{e.v({courses__box:"MyСourses-module__GB8H-q__courses__box",courses__card:"MyСourses-module__GB8H-q__courses__card",courses__complexity:"MyСourses-module__GB8H-q__courses__complexity",courses__days:"MyСourses-module__GB8H-q__courses__days",courses__descrip:"MyСourses-module__GB8H-q__courses__descrip",courses__image:"MyСourses-module__GB8H-q__courses__image",courses__imageSvg:"MyСourses-module__GB8H-q__courses__imageSvg",courses__imgBox:"MyСourses-module__GB8H-q__courses__imgBox",courses__minDay:"MyСourses-module__GB8H-q__courses__minDay",courses__period:"MyСourses-module__GB8H-q__courses__period",courses__periodBox:"MyСourses-module__GB8H-q__courses__periodBox",courses__title:"MyСourses-module__GB8H-q__courses__title",progres__bar:"MyСourses-module__GB8H-q__progres__bar",progres__box:"MyСourses-module__GB8H-q__progres__box",progres__but:"MyСourses-module__GB8H-q__progres__but",progres__link:"MyСourses-module__GB8H-q__progres__link",progres__percent:"MyСourses-module__GB8H-q__progres__percent",progres__scrollbar:"MyСourses-module__GB8H-q__progres__scrollbar"})},53647,e=>{e.v({button__container:"LessonMaterials-module__GMagma__button__container",checkbox__box:"LessonMaterials-module__GMagma__checkbox__box",checkbox__container:"LessonMaterials-module__GMagma__checkbox__container",checkbox__custom:"LessonMaterials-module__GMagma__checkbox__custom",checkbox__input:"LessonMaterials-module__GMagma__checkbox__input",checkbox__text:"LessonMaterials-module__GMagma__checkbox__text",checkmark:"LessonMaterials-module__GMagma__checkmark",completed:"LessonMaterials-module__GMagma__completed",empty:"LessonMaterials-module__GMagma__empty",loading:"LessonMaterials-module__GMagma__loading",menuItem__profil:"LessonMaterials-module__GMagma__menuItem__profil",overlay:"LessonMaterials-module__GMagma__overlay",popup:"LessonMaterials-module__GMagma__popup",selected:"LessonMaterials-module__GMagma__selected",title:"LessonMaterials-module__GMagma__title",workout__box:"LessonMaterials-module__GMagma__workout__box",workout__link:"LessonMaterials-module__GMagma__workout__link",workout__list:"LessonMaterials-module__GMagma__workout__list",workout__progress:"LessonMaterials-module__GMagma__workout__progress",workout__text:"LessonMaterials-module__GMagma__workout__text"})},83858,e=>{"use strict";var s=e.i(43476),r=e.i(57688),o=e.i(80127),t=e.i(22016),a=e.i(71645),l=e.i(90704),i=e.i(70756),u=e.i(18566),d=e.i(53647),n=e.i(72426),_=e.i(87668);function c({isOpen:e,onClose:r,userEmail:o,loginName:t,onLogout:l,courseId:i}){let[c,m]=(0,a.useState)([]),[g,h]=(0,a.useState)([]),[p,x]=(0,a.useState)([]),f=(0,u.useRouter)(),{data:k,isLoading:y}=(0,n.useGetCourseWorkoutsQuery)(i,{skip:!i||!e}),{data:C}=(0,_.useGetUserProgressQuery)({courseId:i},{skip:!i||!e});return((0,a.useEffect)(()=>{k&&m(k),C?.workoutsProgress&&h(C.workoutsProgress)},[k,C]),(0,a.useEffect)(()=>(e&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="auto"}),[e]),e)?(0,s.jsx)("div",{className:d.default.overlay,onClick:e=>{e.target===e.currentTarget&&r()},children:(0,s.jsxs)("div",{className:d.default.popup,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("p",{className:d.default.title,children:"Выберите тренировки"}),(0,s.jsx)("div",{className:d.default.workout__box,children:(0,s.jsx)("div",{className:d.default.workout__list,children:y?(0,s.jsx)("div",{className:d.default.loading,children:"Загрузка тренировок..."}):0===c.length?(0,s.jsx)("div",{className:d.default.empty,children:"Тренировки не найдены"}):c.map(e=>{var r;let o,t;r=e._id,(o=g.find(e=>e.workoutId===r))&&o.workoutCompleted;let a=(e=>{let s=g.find(s=>s.workoutId===e);if(!s)return 0;let r=s.progressData.length;return 0===r?0:Math.round(s.progressData.filter(e=>e>0).length/r*100)})(e._id),l=(t=e._id,p.includes(t));return(0,s.jsxs)("div",{className:d.default.checkbox__box,onClick:()=>{var s;return s=e._id,void x(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},children:[(0,s.jsxs)("div",{className:d.default.checkbox__container,children:[(0,s.jsx)("input",{type:"checkbox",id:`workout-${e._id}`,className:d.default.checkbox__input,checked:l,readOnly:!0}),(0,s.jsx)("div",{className:d.default.checkbox__custom,children:l&&(0,s.jsx)("div",{className:d.default.checkmark,children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",style:{width:"16px",height:"16px",display:"block",margin:"4px auto"},children:(0,s.jsx)("path",{fill:"white",d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})})})]}),(0,s.jsx)("div",{className:d.default.checkbox__text,children:(0,s.jsxs)("span",{className:d.default.workout__link,children:[e.name,a>0&&(0,s.jsxs)("span",{className:`${d.default.workout__progress} ${100===a?d.default.completed:""}`,children:["(",a,"%)"]})]})})]},e._id)})})}),(0,s.jsx)("div",{className:d.default.button__container,children:(0,s.jsx)("button",{className:d.default.menuItem__profil,onClick:()=>{if(p.length>0){let e=p[0],s=encodeURIComponent(p.join(","));f.push(`/page/Video/${e}?courseId=${i}&workoutIds=${s}`),r()}},disabled:0===p.length,children:1===p.length?"Начать":`Начать`})})]})}):null}var m=e.i(7117);let g=async()=>{if(!(0,l.isAuthenticated)())return[];try{let e=localStorage.getItem("auth_token"),s=await fetch("https://wedev-api.sky.pro/api/fitness/users/me",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw Error(`HTTP ${s.status}`);let r=await s.json();if(!r.user||!r.user.selectedCourses)return[];let o=await fetch("https://wedev-api.sky.pro/api/fitness/courses");if(!o.ok)throw Error(`HTTP ${o.status}`);let t=(await o.json()).filter(e=>r.user.selectedCourses.includes(e._id));return console.log("Найдено курсов пользователя:",t.length),t}catch(e){return console.error("Ошибка при получении курсов пользователя:",e),[]}};function h(){let[e,r]=(0,a.useState)(null),[u,d]=(0,a.useState)(!1),[_,h]=(0,a.useState)(null),[k,y]=(0,a.useState)([]),[C,j]=(0,a.useState)(!0),[v]=(0,m.useRemoveCourseFromUserMutation)(),[M]=(0,n.useResetCourseProgressMutation)();(0,a.useEffect)(()=>{let e=async()=>{if(!(0,l.isAuthenticated)()){console.log("Пользователь не авторизован"),y([]),j(!1);return}try{console.log("Загрузка курсов пользователя...");let e=await g();console.log("Загружены курсы:",e),y(e)}catch(e){console.error("Ошибка при загрузке курсов пользователя:",e),y([])}finally{j(!1)}};e();let s=()=>{console.log("Событие courseStateChanged получено"),e()};return window.addEventListener("courseStateChanged",s),()=>{window.removeEventListener("courseStateChanged",s)}},[]);let b=async e=>{if(confirm("Вы уверены, что хотите удалить этот курс? Весь прогресс будет сброшен.")){r(e);try{await M(e).unwrap(),await v(e).unwrap(),y(s=>s.filter(s=>s._id!==e)),window.dispatchEvent(new Event("courseStateChanged"))}catch(e){console.error("Ошибка при удалении курса:",e),alert((0,i.getErrorMessage)(e)||"Ошибка при удалении курса")}finally{r(null)}}},w=(e,s)=>{h({id:e,name:s}),d(!0)};return(0,l.isAuthenticated)()?C?(0,s.jsx)("div",{className:o.default.courses__box,children:(0,s.jsx)("div",{className:o.default.noCourses,children:(0,s.jsx)("p",{className:o.default.noCoursesText,children:"Загрузка курсов..."})})}):0===k.length?(0,s.jsx)("div",{className:o.default.courses__box,children:(0,s.jsxs)("div",{className:o.default.noCourses,children:[(0,s.jsx)("p",{className:o.default.noCoursesText,children:"У вас пока нет добавленных курсов"}),(0,s.jsx)(t.default,{href:"/",className:o.default.browseLink,children:"Посмотреть все курсы"})]})}):(0,s.jsxs)("div",{className:o.default.courses__box,children:[k.slice(0,2).map(r=>(0,s.jsx)(p,{course:r,onDelete:b,onStartTraining:w,deleting:e===r._id},r._id)),(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(f,{}),children:(0,s.jsx)(x,{courses:k.slice(2),onDelete:b,onStartTraining:w,deletingCourseId:e})}),_&&(0,s.jsx)(c,{isOpen:u,onClose:()=>{d(!1),h(null)},userEmail:"",loginName:_.name,courseId:_.id})]}):(0,s.jsx)("div",{className:o.default.courses__box,children:(0,s.jsxs)("div",{className:o.default.noCourses,children:[(0,s.jsx)("p",{className:o.default.noCoursesText,children:"Войдите, чтобы видеть свои курсы"}),(0,s.jsx)(t.default,{href:"/page/SignIn",className:o.default.browseLink,children:"Войти"})]})})}function p({course:e,onDelete:t,onStartTraining:a,deleting:i}){let u,d,{data:c}=(0,_.useGetUserProgressQuery)({courseId:e._id},{skip:!(0,l.isAuthenticated)()}),{data:m}=(0,n.useGetCourseWorkoutsQuery)(e._id,{skip:!(0,l.isAuthenticated)()}),g=(()=>{if(!c||!c.workoutsProgress||0===c.workoutsProgress.length)return 0;if(!m||0===m.length)return Math.round(c.workoutsProgress.filter(e=>e.workoutCompleted).length/c.workoutsProgress.length*100);let e=0,s=0;return(m.forEach(r=>{let o=c.workoutsProgress.find(e=>e.workoutId===r._id);o&&(e+=r.exercises.length,o.progressData.forEach((e,o)=>{let t=r.exercises[o];if(t&&e>0){let r=Math.min(Math.round(e/t.quantity*100),100);s+=r/100}}))}),0===e)?0:Math.round(s/e*100)})(),h=(u=e.nameRU.toLowerCase()).includes("йога")||u.includes("yoga")?"/img/image9.png":u.includes("стретчинг")||u.includes("stretching")?"/img/image 5.png":u.includes("фитнес")||u.includes("fitness")?"/img/Untitled-1 1.png":u.includes("степ")||u.includes("step")||u.includes("аэробик")||u.includes("aerobics")?"/img/image 7.png":u.includes("бодифлекс")||u.includes("bodyflex")?"/img/image 8.png":"/img/image9.png",p=(d=e.difficulty.toLowerCase()).includes("легк")||d.includes("начал")||d.includes("низк")?1:d.includes("средн")?3:d.includes("сложн")||d.includes("продви")||d.includes("эксперт")||d.includes("профес")?5:d.includes("высок")?4:3,x=e.durationInDays?`${e.durationInDays} дней`:"25 дней",f=e.dailyDurationInMinutes?`${e.dailyDurationInMinutes.from}-${e.dailyDurationInMinutes.to} мин/день`:"20-50 мин/день";return(0,s.jsxs)("article",{className:o.default.courses__card,children:[(0,s.jsxs)("div",{className:o.default.courses__imgBox,children:[(0,s.jsx)(r.default,{width:360,height:325,className:o.default.courses__image,src:h,alt:e.nameRU,priority:!0}),(0,s.jsxs)("div",{onClick:()=>t(e._id),title:"Удалить курс",className:o.default.deleteButton,children:[(0,s.jsx)(r.default,{width:32,height:32,className:o.default.courses__imageSvg,src:"/img/Icon.svg",alt:"Удалить курс"}),i&&(0,s.jsx)("div",{className:o.default.deletingOverlay,children:"Удаление..."})]})]}),(0,s.jsxs)("div",{className:o.default.courses__descrip,children:[(0,s.jsx)("h3",{className:o.default.courses__title,children:e.nameRU}),(0,s.jsxs)("div",{className:o.default.courses__periodBox,children:[(0,s.jsxs)("div",{className:o.default.courses__period,children:[(0,s.jsxs)("div",{className:o.default.courses__days,children:[(0,s.jsx)(r.default,{width:18,height:18,className:o.default.courses__daysImg,src:"/img/Calendar.svg",alt:"Calendar"}),(0,s.jsx)("p",{className:o.default.courses__complexity,children:x})]}),(0,s.jsxs)("div",{className:o.default.courses__minDay,children:[(0,s.jsx)(r.default,{width:18,height:18,className:o.default.courses__minDayImg,src:"/img/Time.svg",alt:"Time"}),(0,s.jsx)("p",{className:o.default.courses__minDayDisc,children:f})]}),(0,s.jsxs)("div",{className:o.default.courses__complexity,children:[(0,s.jsxs)("svg",{viewBox:"0 0 18 18",width:"18",height:"18",fill:"none",children:[(0,s.jsx)("path",{d:"M15 2.625C15.2984 2.625 15.5845 2.74353 15.7955 2.9545C16.0065 3.16548 16.125 3.45163 16.125 3.75L16.125 14.25C16.125 14.5484 16.0065 14.8345 15.7955 15.0455C15.5845 15.2565 15.2984 15.375 15 15.375C14.7016 15.375 14.4155 15.2565 14.2045 15.0455C13.9935 14.8345 13.875 14.5484 13.875 14.25L13.875 3.75C13.875 3.45163 13.9935 3.16548 14.2045 2.9545C14.4155 2.74353 14.7016 2.625 15 2.625Z",fill:p>=5?"rgb(0,193,255)":"rgb(217,217,217)"}),(0,s.jsx)("path",{d:"M12 4.875C12.2984 4.875 12.5845 4.99353 12.7955 5.2045C13.0065 5.41548 13.125 5.70163 13.125 6L13.125 14.25C13.125 14.5484 13.0065 14.8345 12.7955 15.0455C12.5845 15.2565 12.2984 15.375 12 15.375C11.7016 15.375 11.4155 15.2565 11.2045 15.0455C10.9935 14.8345 10.875 14.5484 10.875 14.25L10.875 6C10.875 5.70163 10.9935 5.41548 11.2045 5.2045C11.4155 4.99353 11.7016 4.875 12 4.875Z",fill:p>=4?"rgb(0,193,255)":"rgb(217,217,217)"}),(0,s.jsx)("path",{d:"M9 7.125C9.29837 7.125 9.58452 7.24353 9.7955 7.4545C10.0065 7.66548 10.125 7.95163 10.125 8.25L10.125 14.25C10.125 14.5484 10.0065 14.8345 9.7955 15.0455C9.58452 15.2565 9.29837 15.375 9 15.375C8.70163 15.375 8.41548 15.2565 8.2045 15.0455C7.99353 14.8345 7.875 14.5484 7.875 14.25L7.875 8.25C7.875 7.95163 7.99353 7.66548 8.2045 7.4545C8.41548 7.24353 8.70163 7.125 9 7.125Z",fill:p>=3?"rgb(0,193,255)":"rgb(217,217,217)"}),(0,s.jsx)("path",{d:"M6 9.375C6.29837 9.375 6.58452 9.49353 6.7955 9.7045C7.00647 9.91548 7.125 10.2016 7.125 10.5L7.125 14.25C7.125 14.5484 7.00647 14.8345 6.7955 15.0455C6.58452 15.2565 6.29837 15.375 6 15.375C5.70163 15.375 5.41548 15.2565 5.2045 15.0455C4.99353 14.8345 4.875 14.5484 4.875 14.25L4.875 10.5C4.875 10.2016 4.99353 9.91548 5.2045 9.7045C5.41548 9.49353 5.70163 9.375 6 9.375Z",fill:p>=2?"rgb(0,193,255)":"rgb(217,217,217)"}),(0,s.jsx)("path",{d:"M3 11.625C3.29837 11.625 3.58452 11.7435 3.7955 11.9545C4.00647 12.1655 4.125 12.4516 4.125 12.75L4.125 14.25C4.125 14.5484 4.00647 14.8345 3.7955 15.0455C3.58452 15.2565 3.29837 15.375 3 15.375C2.70163 15.375 2.41548 15.2565 2.2045 15.0455C1.99353 14.8345 1.875 14.5484 1.875 14.25L1.875 12.75C1.875 12.4516 1.99353 12.1655 2.2045 11.9545C2.41548 11.7435 2.70163 11.625 3 11.625Z",fill:p>=1?"rgb(0,193,255)":"rgb(217,217,217)"})]}),(0,s.jsx)("p",{className:o.default.courses__complexity,children:e.difficulty||"Средняя"})]})]}),(0,s.jsxs)("div",{className:o.default.progres__box,children:[(0,s.jsxs)("p",{className:o.default.progres__percent,children:["Прогресс ",g,"%"]}),(0,s.jsx)("div",{className:o.default.progres__scrollbar,children:(0,s.jsx)("div",{className:o.default.progres__bar,style:{width:`${g}%`}})})]}),(0,s.jsx)("div",{className:o.default.progres__but,children:(0,s.jsx)("button",{onClick:()=>a(e._id,e.nameRU),className:o.default.progres__link,style:{cursor:"pointer",border:"none",background:"transparent",textDecoration:"none",color:"inherit",fontFamily:"inherit",fontSize:"inherit",padding:0},children:g>0?"Продолжить тренировку":"Начать тренировку"})})]})]})]})}function x({courses:e,onDelete:r,onStartTraining:o,deletingCourseId:t}){return(0,s.jsx)(s.Fragment,{children:e.map(e=>(0,s.jsx)(p,{course:e,onDelete:r,onStartTraining:o,deleting:t===e._id},e._id))})}function f(){return(0,s.jsxs)("article",{className:o.default.courses__card,children:[(0,s.jsx)("div",{className:o.default.skeletonImage}),(0,s.jsxs)("div",{className:o.default.skeletonContent,children:[(0,s.jsx)("div",{className:o.default.skeletonTitle}),(0,s.jsx)("div",{className:o.default.skeletonText}),(0,s.jsx)("div",{className:o.default.skeletonText})]})]})}e.s(["default",()=>h],83858)},79163,e=>{e.n(e.i(83858))}]);