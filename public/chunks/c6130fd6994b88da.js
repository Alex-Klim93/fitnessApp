(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90704,e=>{"use strict";let r="https://wedev-api.sky.pro/api/fitness",t="auth_token",a="user_email",s="user_login",o=()=>localStorage.getItem(a),l=()=>{window.dispatchEvent(new Event("authStateChanged"))},i=async(e,t)=>{let a=await fetch(`${r}/auth/register`,{method:"POST",body:JSON.stringify({email:e,password:t})}),s=await a.json();if(!a.ok)throw Error(s.message||`HTTP ${a.status}`);return s},n=async(e,o)=>{var i;let n,u=await fetch(`${r}/auth/login`,{method:"POST",body:JSON.stringify({email:e,password:o})}),d=await u.json();if(!u.ok)throw Error(d.message||`HTTP ${u.status}`);return i=d.token,localStorage.setItem(t,i),localStorage.setItem(a,e),n=e.split("@")[0],localStorage.setItem(s,n),l(),d};e.s(["getUserEmail",0,o,"getUserLogin",0,()=>{{let e=localStorage.getItem(s);if(e)return e;let r=o();if(r)return r.split("@")[0]}return null},"isAuthenticated",0,()=>!!localStorage.getItem(t),"login",0,n,"logout",0,()=>{localStorage.removeItem(t),localStorage.removeItem(a),localStorage.removeItem(s),l()},"register",0,i])},70756,e=>{"use strict";e.s(["getErrorMessage",0,e=>{if(!e)return"Произошла неизвестная ошибка";if("string"==typeof e)return e;if(e instanceof Error){let r=e.message;if(r.includes("400"))return"Неверный запрос. Проверьте введенные данные";if(r.includes("401"))return"Неверный email или пароль";if(r.includes("409"))return"Пользователь с таким email уже существует";else if(r.includes("422"))return"Некорректные данные. Проверьте введенные значения";else if(r.includes("500"))return"Ошибка сервера. Пожалуйста, попробуйте позже";else if(r.includes("network")||r.includes("Network"))return"Ошибка сети. Проверьте подключение к интернету";return r||"Произошла неизвестная ошибка"}return"message"in e&&"string"==typeof e.message?e.message:"Произошла неизвестная ошибка"}])},32614,e=>{"use strict";let r="https://wedev-api.sky.pro/api/fitness",t=async(e,r={})=>{try{let t,a,s=(t=localStorage.getItem("auth_token"),a={},t&&(a.Authorization=`Bearer ${t}`),a),o={...r,headers:{...s,...r.headers||{}}};o.headers instanceof Headers?o.headers.delete("Content-Type"):Array.isArray(o.headers)?o.headers=o.headers.filter(([e])=>"content-type"!==e.toLowerCase()):"object"==typeof o.headers&&(delete o.headers["Content-Type"],delete o.headers["content-type"]),console.log(`API Request to: ${e}`);let l=await fetch(e,o);if(!l.ok){let e=`HTTP ${l.status}`;try{e=(await l.json()).message||e}catch{try{let r=await l.text();r&&(e=r)}catch{}}throw Error(e)}return await l.json()}catch(r){if(console.error(`API Error for ${e}:`,r),r instanceof Error){if(r.message.includes("Failed to fetch"))throw Error("Не удалось подключиться к серверу. Проверьте интернет-соединение.");if(r.message.includes("401"))throw localStorage.removeItem("auth_token"),Error("Сессия истекла. Пожалуйста, войдите снова.");throw r}throw Error("Произошла неизвестная ошибка")}};e.s(["addCourseToUser",0,e=>t(`${r}/users/me/courses`,{method:"POST",body:JSON.stringify({courseId:e})}),"getCourseById",0,e=>t(`${r}/courses/${e}`),"getCurrentUser",0,()=>t(`${r}/users/me`),"removeCourseFromUser",0,e=>t(`${r}/users/me/courses/${e}`,{method:"DELETE"}),"resetCourseProgress",0,e=>t(`${r}/courses/${e}/reset`,{method:"PATCH"}),"saveWorkoutProgress",0,(e,a,s)=>t(`${r}/courses/${e}/workouts/${a}`,{method:"PATCH",body:JSON.stringify({progressData:s})})])},5767,e=>{"use strict";var r=e.i(64645),t=e.i(90704),a=e.i(70756);let s=(0,r.createAsyncThunk)("auth/loadUserProfile",async(e,{rejectWithValue:r})=>{if(!localStorage.getItem("auth_token"))return null;try{let e=localStorage.getItem("user_email");if(e){let r=localStorage.getItem("user_courses");return{_id:"temp-id",email:e,selectedCourses:r?JSON.parse(r):[]}}return null}catch(e){if(console.error("Ошибка загрузки данных пользователя:",e),e instanceof Error)return r((0,a.getErrorMessage)(e));return r("Неизвестная ошибка загрузки данных пользователя")}}),o=(0,r.createAsyncThunk)("auth/login",async({email:e,password:r},{dispatch:o})=>{try{return await (0,t.login)(e,r),await o(s()),{email:e}}catch(e){if(e instanceof Error)throw Error((0,a.getErrorMessage)(e));throw Error("Неизвестная ошибка входа")}}),l=(0,r.createAsyncThunk)("auth/logout",async()=>((0,t.logout)(),null)),i=(0,r.createSlice)({name:"auth",initialState:{user:null,isAuthenticated:!1,loading:!1,error:null},reducers:{setUser:(e,r)=>{e.user=r.payload,e.isAuthenticated=!0},updateUser:(e,r)=>{e.user&&(e.user={...e.user,...r.payload})},updateUserCourses:(e,r)=>{e.user&&(e.user.selectedCourses=r.payload)},addUserCourse:(e,r)=>{e.user&&!e.user.selectedCourses.includes(r.payload)&&e.user.selectedCourses.push(r.payload)},removeUserCourse:(e,r)=>{e.user&&(e.user.selectedCourses=e.user.selectedCourses.filter(e=>e!==r.payload))},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(s.pending,e=>{e.loading=!0,e.error=null}).addCase(s.fulfilled,(e,r)=>{e.loading=!1,e.user=r.payload,e.isAuthenticated=!!r.payload}).addCase(s.rejected,(e,r)=>{e.loading=!1,e.error=r.payload||"Ошибка загрузки профиля"}).addCase(o.pending,e=>{e.loading=!0,e.error=null}).addCase(o.fulfilled,e=>{e.loading=!1,e.error=null}).addCase(o.rejected,(e,r)=>{e.loading=!1,e.error=r.error.message||"Ошибка входа"}).addCase(l.fulfilled,e=>{e.user=null,e.isAuthenticated=!1,e.loading=!1})}}),{setUser:n,updateUser:u,updateUserCourses:d,addUserCourse:c,removeUserCourse:g,clearError:y}=i.actions,m=i.reducer;e.s(["default",0,m,"loadUserProfile",0,s])},4202,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(55487);e.i(47167);var s=e.i(64645),o=e.i(64722),l=e.i(5767),i=e.i(32614),n=e.i(70756);let u=(0,s.createAsyncThunk)("player/updateProgress",async({courseId:e,workoutId:r,progressData:t})=>{try{return await (0,i.saveWorkoutProgress)(e,r,t),{workoutId:r,progressData:t}}catch(e){if(e instanceof Error)throw Error((0,n.getErrorMessage)(e));throw Error("Неизвестная ошибка при сохранении прогресса")}}),d=(0,s.createSlice)({name:"player",initialState:{currentVideoId:null,currentTime:0,isPlaying:!1,volume:1,playbackRate:1},reducers:{setCurrentVideo:(e,r)=>{e.currentVideoId=r.payload,e.currentTime=0},setCurrentTime:(e,r)=>{e.currentTime=r.payload},setIsPlaying:(e,r)=>{e.isPlaying=r.payload},setVolume:(e,r)=>{e.volume=r.payload},setPlaybackRate:(e,r)=>{e.playbackRate=r.payload},resetPlayer:e=>{e.currentVideoId=null,e.currentTime=0,e.isPlaying=!1,e.volume=1,e.playbackRate=1}},extraReducers:e=>{e.addCase(u.fulfilled,(e,r)=>{console.log("Прогресс тренировки обновлен:",r.payload)}).addCase(u.rejected,(e,r)=>{console.error("Failed to update workout progress:",r.error.message)})}}),{setCurrentVideo:c,setCurrentTime:g,setIsPlaying:y,setVolume:m,setPlaybackRate:h,resetPlayer:p}=d.actions,f=d.reducer,P={currentVideoUrl:null,isPlaying:!1,currentTime:0,duration:0,volume:1,isMuted:!1,playbackRate:1,isFullscreen:!1,isLoading:!1,error:null},T=(0,s.createSlice)({name:"videoPlayer",initialState:P,reducers:{setVideoUrl:(e,r)=>{e.currentVideoUrl=r.payload,e.currentTime=0,e.isPlaying=!1,e.isLoading=!0,e.error=null},playVideo:e=>{e.isPlaying=!0,e.error=null},pauseVideo:e=>{e.isPlaying=!1},togglePlay:e=>{e.isPlaying=!e.isPlaying,e.error=null},setCurrentTime:(e,r)=>{e.currentTime=r.payload},setDuration:(e,r)=>{e.duration=r.payload,e.isLoading=!1},setVolume:(e,r)=>{e.volume=Math.max(0,Math.min(1,r.payload)),e.isMuted=0===e.volume},toggleMute:e=>{e.isMuted=!e.isMuted,e.isMuted?e.volume=0:0===e.volume&&(e.volume=.5)},setPlaybackRate:(e,r)=>{e.playbackRate=[.25,.5,.75,1,1.25,1.5,1.75,2].includes(r.payload)?r.payload:Math.max(.25,Math.min(2,r.payload))},toggleFullscreen:e=>{e.isFullscreen=!e.isFullscreen},seekForward:e=>{e.currentTime=Math.min(e.currentTime+10,e.duration)},seekBackward:e=>{e.currentTime=Math.max(e.currentTime-10,0)},seekTo:(e,r)=>{e.currentTime=Math.max(0,Math.min(r.payload,e.duration))},setLoading:(e,r)=>{e.isLoading=r.payload},setError:(e,r)=>{e.error=r.payload,e.isLoading=!1,r.payload&&(e.isPlaying=!1)},resetVideoPlayer:e=>P,restoreVideoState:(e,r)=>({...e,...r.payload})}}),{setVideoUrl:w,playVideo:C,pauseVideo:S,togglePlay:k,setCurrentTime:v,setDuration:E,setVolume:I,toggleMute:A,setPlaybackRate:$,toggleFullscreen:b,seekForward:M,seekBackward:U,seekTo:R,setLoading:V,setError:L,resetVideoPlayer:j,restoreVideoState:O}=T.actions,_=T.reducer;var x=e.i(38114);let F=null,H=()=>(F||(F=(0,s.configureStore)({reducer:{[x.apiSlice.reducerPath]:x.apiSlice.reducer,auth:l.default,player:f,videoPlayer:_},middleware:e=>e({serializableCheck:{ignoredActions:["videoPlayer/setError","videoPlayer/setLoading"],ignoredPaths:["videoPlayer.error"]},immutableCheck:{warnAfter:100}}).concat(x.apiSlice.middleware),devTools:!1}),(0,o.setupListeners)(F.dispatch)),F);function N({children:e}){let s=(0,t.useRef)(null);if((0,t.useRef)(null),s.current||(s.current=H()),!s.current)throw Error("Store not initialized");return(0,r.jsx)(a.Provider,{store:s.current,children:e})}H(),e.s(["default",()=>N],4202)}]);